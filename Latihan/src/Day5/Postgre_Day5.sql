--INCREMENT
SELECT*FROM PEGAWAI

CREATE TABLE MAHASISWA(
ID SERIAL PRIMARY KEY,
	NAMA TEXT
)
CREATE TABLE PEGAWAI3(
	ID_PEGAWAI SERIAL PRIMARY KEY,
	UMUR INTEGER,
	NAMA_PEGAWAI TEXT
)

ALTER TABLE PEGAWAI3 ALTER COLUMN ID_PEGAWAI ADD GENERATED BY DEFAULT AS IDENTITY

ALTER SEQUENCE PEGAWAI3_IDPEGAWAI_SEQ RESTART WITH 7
INSERT INTO PEGAWAI(UMUR,NAMA_PEGAWAI)VALUES(23,'IWAN')

CREATE TABLE public.kota (
    id integer NOT NULL,
    nama text,
    id_propinsi integer
)

Delete from kota
Select*from kota

INSERT INTO kota (id, nama, id_propinsi) VALUES (1, 'Jakarta', 1);
INSERT INTO kota (id, nama, id_propinsi) VALUES (2, 'Bandung', 2);
INSERT INTO kota (id, nama, id_propinsi) VALUES (3, 'Sumedang', 2);
INSERT INTO kota (id, nama, id_propinsi) VALUES (4, 'Makasar', 4);
INSERT INTO kota (id, nama, id_propinsi) VALUES (5, 'Surabaya', 5);
INSERT INTO kota (id, nama, id_propinsi) VALUES (6, 'Medan', 6);

CREATE TABLE propinsi (
    id integer NOT NULL,
    nama text
);

INSERT INTO propinsi (id, nama) VALUES (1, 'DKI Jakarta');
INSERT INTO propinsi (id, nama) VALUES (2, 'Jawa Barat');
INSERT INTO propinsi (id, nama) VALUES (3, 'Papua Barat');
INSERT INTO propinsi (id, nama) VALUES (4, 'Sulawesi Selatan');
INSERT INTO propinsi (id, nama) VALUES (5, 'Jawa Timur');

SELECT*FROM PROPINSI;

-- INNER JOIN
SELECT A.NAMA, B.NAMA FROM KOTA A JOIN PROPINSI B
ON A.ID=B.ID;

-- LEFT JOIN
SELECT A.NAMA, B.NAMA FROM KOTA A LEFT JOIN PROPINSI B
ON A.ID=B.ID;

-- RIGHT JOIN
SELECT A.NAMA, B.NAMA FROM KOTA A RIGHT JOIN PROPINSI B
ON A.ID=B.ID;

-- OUTER JOIN
SELECT A.NAMA, B.NAMA FROM KOTA A FULL OUTER JOIN PROPINSI B
ON A.ID=B.ID;

--WILD
SELECT A.NAMA, B.NAMA FROM KOTA A,PROPINSI B WHERE A.ID=B.ID;

CREATE TABLE public.produser (
    kd_produser character varying(5) NOT NULL,
    nm_produser character varying(50),
    international character varying(10)
);

INSERT INTO public.produser (kd_produser, nm_produser, international) VALUES ('PD01', 'MARVEL', 'YA');
INSERT INTO public.produser (kd_produser, nm_produser, international) VALUES ('PD02', 'HONGKONG CINEMA', 'YA');
INSERT INTO public.produser (kd_produser, nm_produser, international) VALUES ('PD03', 'RAPI FILM', 'TIDAK');
INSERT INTO public.produser (kd_produser, nm_produser, international) VALUES ('PD04', 'PARKIT FILM', 'TIDAK');
INSERT INTO public.produser (kd_produser, nm_produser, international) VALUES ('PD05', 'PARAMOUNT PICTURE', 'YA');

CREATE TABLE public.negara (
    kd_negara character varying(5) NOT NULL,
    nm_negara character varying(50)
);

INSERT INTO public.negara (kd_negara, nm_negara) VALUES ('AS', 'AMERIKA SERIKAT');
INSERT INTO public.negara (kd_negara, nm_negara) VALUES ('HK', 'HONGKONG');
INSERT INTO public.negara (kd_negara, nm_negara) VALUES ('ID', 'INDONESIA');
INSERT INTO public.negara (kd_negara, nm_negara) VALUES ('IN', 'INDIA');

CREATE TABLE public.genre (
    kd_genre character varying(5) NOT NULL,
    nm_genre character varying(50)
);

INSERT INTO public.genre (kd_genre, nm_genre) VALUES ('G001', 'ACTION');
INSERT INTO public.genre (kd_genre, nm_genre) VALUES ('G002', 'HORROR');
INSERT INTO public.genre (kd_genre, nm_genre) VALUES ('G003', 'COMEDY');
INSERT INTO public.genre (kd_genre, nm_genre) VALUES ('G004', 'DRAMA');
INSERT INTO public.genre (kd_genre, nm_genre) VALUES ('G005', 'THRILER');
INSERT INTO public.genre (kd_genre, nm_genre) VALUES ('G006', 'FICTION');

CREATE TABLE public.artis (
    kd_artis character varying(5) NOT NULL,
    nm_artis character varying(50),
    jk character varying(10),
    bayaran integer,
    award integer,
    negara character varying(5)
);

INSERT INTO public.artis (kd_artis, nm_artis, jk, bayaran, award, negara) VALUES ('A001', 'ROBERT DOWNEY JR', 'PRIA', 1000000000, 2, 'AS');
INSERT INTO public.artis (kd_artis, nm_artis, jk, bayaran, award, negara) VALUES ('A003', 'JACKIE CHAN', 'PRIA', 1200000000, 7, 'HK');
INSERT INTO public.artis (kd_artis, nm_artis, jk, bayaran, award, negara) VALUES ('A004', 'JOE TASLIM', 'PRIA', 350000000, 1, 'ID');
INSERT INTO public.artis (kd_artis, nm_artis, jk, bayaran, award, negara) VALUES ('A005', 'CHELSEA ISLAN', 'WANITA', 300000000, 0, 'ID');
INSERT INTO public.artis (kd_artis, nm_artis, jk, bayaran, award, negara) VALUES ('A002', 'ANGELINA JOLIE', 'WANITA', 700000000, 1, 'AS');

SELECT*FROM GENRE
SELECT*FROM ARTIS
SELECT*FROM NEGARA
SELECT*FROM FILM

-- 14 TAMPILKAN NAMA FILM DAN ARTISNYA
SELECT A.NM_FILM,B.NM_ARTIS FROM FILM A JOIN ARTIS B ON A.ARTIS=B.KD_ARTIS;

-- 15 TAMPILKAN FILM YANG ARTISNYA BERASAL DARI HONGKONG
SELECT NM_FILM,NM_NEGARA FROM FILM A JOIN ARTIS B ON
A.ARTIS = B.KD_ARTIS JOIN NEGARA C ON
B.NEGARA = C.KD_NEGARA

-- 16 TAMPILKAN NAMA FILM YG ARTISNYA BERASAL DR NEGARA YG TIDAK MENGANDUNG HURUF 'O'
SELECT NM_FILM, NM_NEGARA FROM FILM A JOIN ARTIS B ON
A.ARTIS = B.KD_ARTIS JOIN NEGARA C ON
B.NEGARA = KD_NEGARA
WHERE LOWER(NM_NEGARA) NOT LIKE LOWER ('%o%')

-- 17 TAMPILKAN NAMA FILM DAN ARTIS YANG MEMILIKI AWARD TERBANYAK
SELECT A.NM_FILM, B.NM_ARTIS FROM FILM A JOIN ARTIS B ON
A.ARTIS = B.KD_ARTIS WHERE B.AWARD = (SELECT MAX(AWARD)FROM ARTIS C JOIN FILM D ON D.ARTIS=C.KD_ARTIS)

--18 TAMPILKAN NAMA FILM DENGAN ARTIS BAYARAN TERENDAH
SELECT A.NM_FILM, B.NM_ARTIS FROM FILM A JOIN ARTIS B ON
A.ARTIS = B.KD_ARTIS WHERE B.BAYARAN = (SELECT MIN(BAYARAN)FROM ARTIS C JOIN FILM D ON D.ARTIS=C.KD_ARTIS)

--19 TAMPILKAN NAMA ARTIS YG TIDAK PERNAH BERMAIN FILM
SELECT A.KD_FILM, A.NM_FILM, B.NM_ARTIS FROM FILM A RIGHT JOIN ARTIS B ON
A.ARTIS = B.KD_ARTIS WHERE A.NM_FILM IS NULL 

SELECT COUNT(A.NM_FILM) AS "JUMLAH FILM", B.NM_ARTIS FROM FILM A RIGHT JOIN ARTIS B ON
A.ARTIS = B.KD_ARTIS GROUP BY B.NM_ARTIS HAVING COUNT(A.NM_FILM)=0

--20 TAMPILKAN NAMA ARTIS YG BERMAIN FILM DENGAN GENRE DRAMA
SELECT A.NM_FILM, C.NM_GENRE AS "GENRE FILM",B.NM_ARTIS FROM FILM A JOIN ARTIS B ON
A.ARTIS = B.KD_ARTIS JOIN GENRE C ON A.GENRE=C.KD_GENRE WHERE C.NM_GENRE LIKE '%DRAMA%'

--21 TAMPILKAN NAMA ARTIS YG BERMAIN FILM DENGAN GENRE HORROR
SELECT A.NM_FILM, C.NM_GENRE AS "GENRE FILM",B.NM_ARTIS FROM FILM A JOIN ARTIS B ON
A.ARTIS = B.KD_ARTIS JOIN GENRE C ON A.GENRE=C.KD_GENRE WHERE C.NM_GENRE LIKE '%HORROR%'

--22 TAMPILKAN NAMA FILM YG DIBINTANGI OLEH ARTIS YG HURUF DEPANNYA 'J'
SELECT A.NM_FILM, B.NM_ARTIS FROM FILM A JOIN ARTIS B ON
A.ARTIS = B.KD_ARTIS WHERE B.NM_ARTIS LIKE 'J%'


